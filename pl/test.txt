||RÉSOLUTION DU TICKET||
||DÉTAIL DU PROBLÈME||
|   EXCEPTION LORS DU LANCEMENT DU RECALCULATEAQUISITIONLINE BATCH|
||TYPE DE RESOLUTION||
| DATA FIX|
||DÉTAIL DE LA RESOLUTION||
|LE FIX CONSISTE À CORRIGER LES INCOHÉRENCES DÉTÉCTÉS DANS LES LACS LORS DU LANCEMENT DU BATCH|
||DATA FIX||
| SUITE À UNE INVESTIGATION, ON A DÉTÉCTÉ 3 CATÉGORIES DE POLICES IMPACTÉS :
POLICES IMPACTÉS SUITE À UN AJUSTEMENT *(QUERY 1)*: 
 LES MOVEMENT RECALCULÉ ONT UN FLAG "ADJUSTMENT REFERENCE" QUI EMPÊCHE SOLIFE DE LES DÉTECTER MAIS IL TRAITE DES LACS QUI ONT ÉTÉ LIÉ A CE MOUVEMENT.
 QUERY VOLUMÉTRIQUE (Y COMPRIS 4 POLICES DU TABLEAU ) : 
{CODE:JAVA}
;
{CODE}
 +PROCÉDURE DE CORRECTION :+ 
 IL FAUT FAIRE UN AJUSTEMENT ET REVENIR AVANT LE DERNIER AJUSTEMENT DÉJÀ ENCODÉ SUR LA POLICE.
 POLICES IMPACTÉS SUITE À UN DÉCALAGE DES DATES VALEUR DES LACS *(QUERY 2)* :
 LES LACS CONCERNÉ SONT CRÉER EN RÉTRO, CE QUI ENGENDRE UN PROBLÈME D'ORDRE DE TRAITEMENT AU COURS DU PROCESS DE RECALCULE.
{CODE:JAVA}
;
{CODE}
+PROCÉDURE DE CORRECTION :+
 IL FAUT EXECUTER LA QUERY CI-DESSOUS POUR CORRIGER LES MOVEMENTS :
{CODE:JAVA}
DECLARE
    CURSOR CUR IS
        ; VAR CUR%ROWTYPE; NEWVALUEDATE MOVEMENT.VALUE_DATE%TYPE;
BEGIN
    DBMS_OUTPUT.PUT_LINE(
            ' ************************************************************************************************** ');
    DBMS_OUTPUT.PUT_LINE(
            ' ******************************** FIX FOR RUNCLV-3328 *********************************************** ');
    DBMS_OUTPUT.PUT_LINE(
            ' ************************************************************************************************** ');
    DBMS_OUTPUT.NEW_LINE();
    OPEN CUR;
    LOOP
        FETCH CUR INTO VAR;
        EXIT WHEN CUR%NOTFOUND;
        DBMS_OUTPUT.PUT_LINE(' POLICY NUMBER : .' || VAR.POLNUM);

        ;

        UPDATE MOVEMENT
        SET VALUE_DATE            = NEWVALUEDATE,
            MODIFICATION_ACTOR='RUNCLV-3328',
            MODIFICATION_DATE_TIME= TO_DATE(SYSDATE, 'DD/MM/YYYY')
        WHERE OID = VAR.MOV;

        DBMS_OUTPUT.PUT_LINE(' MOVEMENT VALUE_DATE UPDATED WITH VALUE.' || NEWVALUEDATE);
    END LOOP;
    DBMS_OUTPUT.NEW_LINE();
    DBMS_OUTPUT.PUT_LINE(
            ' ************************************************************************************************** ');
    DBMS_OUTPUT.PUT_LINE(CUR%ROWCOUNT || ' ROWS ARE UPDATED.');
    DBMS_OUTPUT.PUT_LINE(
            ' ************************************************************************************************** ');
    CLOSE CUR;
END;
COMMIT;{CODE}
ON A DÉTECTÉ DEUX AUTRES PROBLÉMES DANC CE TICKET:
PROBLÈME 1: DES MOVEMENTS MIGRÉS AVEC LA MÊME VALUE DATE/BOOKINGDATE MAIS AVEC DES SEQUENCENUMBER DIFFÉRENT => LES MOVEMENTS NE SONT PAS EXTRACTÉS DANS L'ORDRE, DONC ON AURA DES LAC AVEC DES MOVEMENT ORIGINE NON CORRECTS :
SOLUTION : MODIFIER LA BOOKINGDATE POUR RÉCUPÉRER LES MOVEMENTS DANS LE BON ORDRE.
 REQUÊTE DE DETECTION [^NEWQUERYSELECT3.TXT]
  REQUÊTE DE MISE A JOURS [^NEWQUERYUPDATE3.TXT]
PROBLÈME 2: DES LAC MIGRÉS AVEC LA MÊME ACQUISITIONLINEDATE => AU LIEU DE CRÉER UNE NOUVELLE LAC SOLIFE VA UTILISER UNE LAC QUI EXISTE DÉJÀ =>ON SE RETROUVE AVEC DES LAC AYANT UNE ORIGINETYPE WITHDRAWAL (CAR SOLIFE N' A PAS RETROUVÉ UNE LAC LIÉ AU MOVEMENT À L'ORIGINE DU MOUVEMENT À TRAITER)
SOLUTION : MODIFIER LES ACQUISITIONLINEDATE  POUR NE PAS AVOIR LA MÊME DATE POUR TOUTES LES LAC
REQUÊTE DE MISE A JOURS POUR LA POLICE OFI010003152 :  [^QUERY2.SQL]
 NB : LE FICHIER [^BOOK 19 (2).XLSX] CONTIENT TOUTES LES POLICES DE CE TICKET||